{"ast":null,"code":"import { setLocalStorage, getFromLocalStorage } from './local-storage';\nconst ENC_KEY = '2bdVweTeI42s5mkLdYHyklTMxQS5gLA7MDS6FA9cs1uobDXeruACDic0YSU3si04JGZe4Y';\nconst BASE_URL = process.env.REACT_APP_API;\n\nconst makeRequest = async _ref => {\n  let {\n    url,\n    method,\n    data = null\n  } = _ref;\n  url = BASE_URL + url;\n  let headers = {\n    \"accept\": \"*/*\"\n  };\n  let user = getFromLocalStorage('user');\n\n  const updateUserSession = () => {\n    if (user) {\n      setLocalStorage('user', user);\n    }\n  };\n\n  headers = { ...headers,\n    ...{\n      \"content-type\": \"application/json\"\n    }\n  };\n  const token = user === null || user === void 0 ? void 0 : user.token;\n\n  if (token) {\n    headers = { ...headers,\n      ...{\n        Authorization: \"Bearer \" + token\n      }\n    };\n  }\n\n  try {\n    let request = {\n      method: method,\n      mode: 'cors',\n      cache: 'no-cache',\n      credentials: 'same-origin',\n      headers: headers,\n      redirect: 'follow',\n      referrerPolicy: 'no-referrer'\n    };\n\n    if (data) {\n      request['body'] = JSON.stringify(data);\n    }\n\n    const response = await fetch(url, request);\n    let result = await response.json();\n    let status = response === null || response === void 0 ? void 0 : response.status;\n    return [status, result];\n  } catch (err) {\n    var _err$response, _err$response2;\n\n    let status = (_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.status,\n        result = (_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : _err$response2.data;\n    return [status, result];\n  } finally {\n    updateUserSession();\n  }\n};\n\nexport default makeRequest;","map":{"version":3,"names":["setLocalStorage","getFromLocalStorage","ENC_KEY","BASE_URL","process","env","REACT_APP_API","makeRequest","url","method","data","headers","user","updateUserSession","token","Authorization","request","mode","cache","credentials","redirect","referrerPolicy","JSON","stringify","response","fetch","result","json","status","err"],"sources":["/Users/wachiye/works/uncover/staff/src/utils/fetch-request.js"],"sourcesContent":["import { setLocalStorage, getFromLocalStorage } from './local-storage';\nconst ENC_KEY = '2bdVweTeI42s5mkLdYHyklTMxQS5gLA7MDS6FA9cs1uobDXeruACDic0YSU3si04JGZe4Y';\nconst BASE_URL = process.env.REACT_APP_API;\n\nconst makeRequest = async ({ url, method, data = null}) => {\n    \n    url = BASE_URL + url;\n    let headers = {\n       \"accept\": \"*/*\"\n    };\n\n    let user = getFromLocalStorage('user');\n\n    const updateUserSession = () => {\n        if(user){\n           setLocalStorage('user', user);\n        }\n    }\n\n    headers = { ...headers, ...{\"content-type\": \"application/json\"} }\n\n    const token = user?.token;\n\n    if(token){\n        headers = { ...headers, ...{Authorization : \"Bearer \" + token}}\n    }\n    try {\n          let request = {\n            method: method,\n            mode: 'cors',\n            cache: 'no-cache',\n            credentials: 'same-origin',\n            headers: headers,\n            redirect: 'follow',\n            referrerPolicy: 'no-referrer',\n          }\n          if(data) {\n              request['body'] = JSON.stringify(data)\n          }\n\n          const response = await fetch(url, request);\n          let result = await response.json();\n          let status = response?.status;\n          return [status, result];\n    } catch(err){\n        let status = err.response?.status,\n            result = err.response?.data;\n        return [status, result]\n    } finally  {\n        updateUserSession();\n    }\n};\n\nexport default makeRequest;\n\n"],"mappings":"AAAA,SAASA,eAAT,EAA0BC,mBAA1B,QAAqD,iBAArD;AACA,MAAMC,OAAO,GAAG,wEAAhB;AACA,MAAMC,QAAQ,GAAGC,OAAO,CAACC,GAAR,CAAYC,aAA7B;;AAEA,MAAMC,WAAW,GAAG,cAAuC;EAAA,IAAhC;IAAEC,GAAF;IAAOC,MAAP;IAAeC,IAAI,GAAG;EAAtB,CAAgC;EAEvDF,GAAG,GAAGL,QAAQ,GAAGK,GAAjB;EACA,IAAIG,OAAO,GAAG;IACX,UAAU;EADC,CAAd;EAIA,IAAIC,IAAI,GAAGX,mBAAmB,CAAC,MAAD,CAA9B;;EAEA,MAAMY,iBAAiB,GAAG,MAAM;IAC5B,IAAGD,IAAH,EAAQ;MACLZ,eAAe,CAAC,MAAD,EAASY,IAAT,CAAf;IACF;EACJ,CAJD;;EAMAD,OAAO,GAAG,EAAE,GAAGA,OAAL;IAAc,GAAG;MAAC,gBAAgB;IAAjB;EAAjB,CAAV;EAEA,MAAMG,KAAK,GAAGF,IAAH,aAAGA,IAAH,uBAAGA,IAAI,CAAEE,KAApB;;EAEA,IAAGA,KAAH,EAAS;IACLH,OAAO,GAAG,EAAE,GAAGA,OAAL;MAAc,GAAG;QAACI,aAAa,EAAG,YAAYD;MAA7B;IAAjB,CAAV;EACH;;EACD,IAAI;IACE,IAAIE,OAAO,GAAG;MACZP,MAAM,EAAEA,MADI;MAEZQ,IAAI,EAAE,MAFM;MAGZC,KAAK,EAAE,UAHK;MAIZC,WAAW,EAAE,aAJD;MAKZR,OAAO,EAAEA,OALG;MAMZS,QAAQ,EAAE,QANE;MAOZC,cAAc,EAAE;IAPJ,CAAd;;IASA,IAAGX,IAAH,EAAS;MACLM,OAAO,CAAC,MAAD,CAAP,GAAkBM,IAAI,CAACC,SAAL,CAAeb,IAAf,CAAlB;IACH;;IAED,MAAMc,QAAQ,GAAG,MAAMC,KAAK,CAACjB,GAAD,EAAMQ,OAAN,CAA5B;IACA,IAAIU,MAAM,GAAG,MAAMF,QAAQ,CAACG,IAAT,EAAnB;IACA,IAAIC,MAAM,GAAGJ,QAAH,aAAGA,QAAH,uBAAGA,QAAQ,CAAEI,MAAvB;IACA,OAAO,CAACA,MAAD,EAASF,MAAT,CAAP;EACL,CAlBD,CAkBE,OAAMG,GAAN,EAAU;IAAA;;IACR,IAAID,MAAM,oBAAGC,GAAG,CAACL,QAAP,kDAAG,cAAcI,MAA3B;IAAA,IACIF,MAAM,qBAAGG,GAAG,CAACL,QAAP,mDAAG,eAAcd,IAD3B;IAEA,OAAO,CAACkB,MAAD,EAASF,MAAT,CAAP;EACH,CAtBD,SAsBW;IACPb,iBAAiB;EACpB;AACJ,CA/CD;;AAiDA,eAAeN,WAAf"},"metadata":{},"sourceType":"module"}